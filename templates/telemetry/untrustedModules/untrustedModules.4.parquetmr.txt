message untrusted-modules {
  @TELEMETRY_ENVIRONMENT_1_TXT@
  optional binary clientId (UTF8);
  required binary creationDate (UTF8);
  required binary id (UTF8);
  required binary type (UTF8);
  required double version;
  required group payload {
    required int64 structVersion;
    required group processes (MAP) {
      repeated group key_value {
        required binary key (UTF8);
        required group value {
          required binary processType (UTF8);
          required double elapsed;
          optional double xulLoadDurationMS;
          required int64 sanitizationFailures;
          required int64 trustTestFailures;
          required group events (LIST) {
            repeated group list {
              required group element {
                required int64 processUptimeMS;
                optional double loadDurationMS;
                required int64 threadID;
                optional binary threadName (UTF8);
                optional binary requestedDllName (UTF8);
                required binary resolvedDllName (UTF8);
                required binary baseAddress (UTF8);
                optional binary fileVersion (UTF8);
                required int64 moduleTrustFlags;
              }
            }
          }
          required group combinedStacks {
            required group memoryMap (LIST) {
              repeated group list {
                required group element (TUPLE) {
                  required binary moduleName (UTF8);
                  required binary debugId (UTF8);
                }
              }
            }
            required group stacks (LIST) {
              repeated group list {
                required group element (LIST) {
                  repeated group list {
                    required group element (TUPLE) {
                      required int64 moduleIndex;
                      required int64 moduleOffset;
                    }
                  }
                }
              }
            }
          }
        }
      }
    }
  }
  @TELEMETRY_APPLICATION_1_TXT@
  required group metadata {
    required int64 Timestamp;
    required binary submissionDate (UTF8);
    optional binary Date (UTF8);
    required binary normalizedChannel (UTF8);
    required binary geoCountry (UTF8);
    required binary geoCity (UTF8);
    required binary appVersion (UTF8);
    required binary appBuildId (UTF8);
  }
}
